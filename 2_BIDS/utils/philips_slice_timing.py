#!/usr/bin/env python# gets slice timing data for Phillips json file.# based on Chris Rorden's MATLAB code at https://neurostars.org/t/heudiconv-no-extraction-of-slice-timing-data-based-on-philips-dicoms/2201/12# requires that the corresponding nifti 'nii' extensionimport os.path as opimport osimport numpy as npimport jsonimport globdef philips_slice_timing(jsonPath, niftiPath=None, ascending=True, interleaved=False):    if not niftiPath:        niftiPath = glob.glob(f"{jsonPath[:-5]}.nii*")[0]    jsondata = json.load(open(jsonPath, 'r+'))    TR = jsondata['RepetitionTime']    hdrdata = os.popen(f"fslinfo {niftiPath}").readlines()    for line in hdrdata:        if line.startswith('dim3'):            num_slices = int(line.split()[-1])    TA = TR / num_slices # assumes no temporal gap between volumes    slice_timing = np.arange(0,TR,TA) # ascending    if not ascending:        slice_timing = np.flip(slice_timing)    if interleaved:        slice_timing = np.concatenate((slice_timing[0::2], slice_timing[1::2]))    return list(slice_timing)